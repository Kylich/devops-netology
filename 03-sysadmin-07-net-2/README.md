# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

- вот несколько способов в Linux
```bash
vagrant@vagrant:/sys/class/net$ ls
eth0  eth1  lo
```
- или

```bash
vagrant@vagrant:/sys/class/net$ ip -br link show
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>
eth0             UP             08:00:27:b1:28:5d <BROADCAST,MULTICAST,UP,LOWER_UP>
eth1             DOWN           08:00:27:3b:34:7e <BROADCAST,MULTICAST>
```
- или
```bash
vagrant@vagrant:/sys/class/net$ ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255
        inet6 fe80::a00:27ff:feb1:285d  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:b1:28:5d  txqueuelen 1000  (Ethernet)
        RX packets 34218  bytes 24718362 (24.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 27686  bytes 2306501 (2.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 176  bytes 16684 (16.6 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 176  bytes 16684 (16.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

- в Windows
```bash
C:\Windows\system32>ipconfig
Адаптер Ethernet VirtualBox Host-Only Network:
   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::d481:6a6a:92b1:7bc7%9
   IPv4-адрес. . . . . . . . . . . . : 192.168.56.1
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . :

Адаптер Ethernet VirtualBox Host-Only Network #2:
   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::d1af:fbf7:8a4c:fda8%12
   IPv4-адрес. . . . . . . . . . . . : 192.168.33.1
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . :

Адаптер Ethernet Ethernet:
   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::54bc:53f5:b269:973f%10
   IPv4-адрес. . . . . . . . . . . . : 192.168.0.63
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . : 192.168.0.1
```
---
2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
- Протокол обнаружения соседей Link Layer Discovery Protocol (LLDP), в linux используются команда lldpctl из пакета lldpd
---
3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.
- Технология виртуальных сетей VLAN. В linux используется одноименный пакет vlan
```bash
network:
  ethernets:
    enp1s0:
      dhcp4: false
      addresses:
        - 192.168.122.201/24
      gateway4: 192.168.122.1
      nameservers:
          addresses: [8.8.8.8, 1.1.1.1]
    vlans:
        enp1s0.100:
            id: 100
            link: enp1s0
            addresses: [192.168.100.2/24]
```
---
4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.
- Типы агрегации:
   - mode=0 (balance-rr) - в данном режиме пакеты отправляются "по кругу";
   - mode=1 (active-backup) - при active-backup один интерфейс работает в активном режиме, остальные в ожидающем. Если активный падает, управление передается одному из ожидающих;
   - mode=2 (balance-xor) - передача пакетов распределяется между объединенными интерфейсами по формуле ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов;
   - mode=3 (broadcast) - происходит передача во все объединенные интерфейсы, обеспечивая отказоустойчивость;
   - mode=4 (802.3ad) - динамическое объединение портов коммутатора;
   - mode=5 (balance-tlb) - адаптивная балансировка нагрузки (входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса)
   - mode=6 (balance-alb) - адаптивная балансировка нагрузки (более совершенная). Обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP)
- пример конфигурации:
```bash
bonds:
   bond0:
      dhcp4: yes
      interfaces:
      - ens1
      - ens2
      parameters:
      mode: balance-alb
      mii-monitor-interval: 2
```
---
5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
- в подсети с маской /29 8 IP адресов;
- в подсеть с маской /24 (256 IP-адресов) можно вместить 32 подсети с маской /29;
- примеры подсетей /29: 10.10.10.0 - 10.10.10.7 , 10.10.10.8 - 10.10.10.15 и т.д.
---
6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.
- можно использовать зарезервированные для CG-NAT адреса 100.64.0.0/10 , маска будет /26 - 62 хоста
---
7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?
- Проверка таблицы
   - Linux - `$ arp -n`
   - Windows - `> arp -a`

- Очистка кэш
   - Linux - `$ ip neigh flush`
   - Windows - `> arp -d *`

- Удаление IP
   - Linux - `$ arp -d <IP>`
   - Windows - `> arp -d <IP>`

---
---
---
 8. \* Установите эмулятор EVE-ng.
 Инструкция по установке - https://github.com/svmyasnikov/eve-ng
 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng.
-
